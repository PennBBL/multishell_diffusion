#!/bin/bash

dsiBin=/share/apps/dsistudio/2016-01-25/bin/dsi_studio
general=/data/joy/BBL/studies/grmpy/rawData/*/*

# Subject locations and loop
for i in $general;do 
	bblIDs=$(echo ${i}|cut -d'/' -f8 |sed s@'/'@' '@g);
	SubDate_and_ID=$(echo ${i}|cut -d'/' -f9|sed s@'/'@' '@g|sed s@'x'@'x'@g)
	Date=$(echo ${SubDate_and_ID}|cut -d',' -f1)
	ID=$(echo ${SubDate_and_ID}|cut -d',' -f2)

# Input file locations
	inputnifti=$(echo /data/joy/BBL/projects/multishell_diffusion/processedData/multishellPipelineFall2017/${bblIDs}/${SubDate_and_ID}/dsi/${bblIDs}_${SubDate_and_ID}t1_maskedEddied.src.gz)
	bval=$(echo /data/joy/BBL/projects/multishell_diffusion/processedData/multishellPipelineFall2017/${bblIDs}/${SubDate_and_ID}/prestats/qa/*roundedbval.bval)
	bvec=$(echo /data/joy/BBL/projects/multishell_diffusion/processedData/multishellPipelineFall2017/${bblIDs}/${SubDate_and_ID}/prestats/eddy/*eddied.eddy_rotated_bvecs)
#template to d space
antsApplyTransforms -e 3 -d 3 -i ~/2mm.nii.gz -r ${inputnifti} -o ~/${bblIDs}_${SubDate_and_ID}_Eddy_Std.nii.gz -t [/data/joy/BBL/studies/grmpy/processedData/structural/struct_pipeline_20170716/$bblIDs/$SubDate_and_ID/antsCT/*SubjectToTemplate1Warp.nii.gz, 1] -t /data/joy/BBL/studies/grmpy/processedData/structural/struct_pipeline_20170716/$bblIDs/$SubDate_and_ID/antsCT/*TemplateToSubject1GenericAffine.mat -t [$out/coreg/${bblIDs}_${SubDate_and_ID}_MultiShDiff2StructRas.mat, 1]
